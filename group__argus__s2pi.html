<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AFBR-S50 API Reference Manual: S2PI: Serial Peripheral Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="AFBR-S50.ico"/></td>
  <td id="projectalign">
   <div id="projectname">AFBR-S50 API Reference Manual<span id="projectnumber">&#160;v1.6.5</span>
   </div>
   <div id="projectbrief">AFBR-S50 Time-of-Flight Sensor SDK for Embedded Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__argus__s2pi.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">S2PI: Serial Peripheral Interface<div class="ingroups"><a class="el" href="group__argus.html">AFBR-S50 SDK</a> &raquo; <a class="el" href="group__argus__hal.html">Hardware Abstraction Layers</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>S2PI: SPI incl. GPIO Hardware Layer Module.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for S2PI: Serial Peripheral Interface:</div>
<div class="dyncontent">
<div class="center"><img src="group__argus__s2pi.png" border="0" usemap="#agroup____argus____s2pi" alt=""/></div>
<map name="agroup____argus____s2pi" id="agroup____argus____s2pi">
<area shape="rect" href="group__argus__hal.html" title="Collection of all interfaces for the Hardware Abstraction Layers (HAL)." alt="" coords="5,5,152,46"/>
<area shape="rect" title="S2PI: SPI incl. GPIO Hardware Layer Module." alt="" coords="200,5,350,46"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga0146c4f3ef32320d6fc869b9018ffeeb" id="r_ga0146c4f3ef32320d6fc869b9018ffeeb"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0146c4f3ef32320d6fc869b9018ffeeb">s2pi_callback_t</a>) (<a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> <a class="el" href="group__argus__xtk__cli.html#gaea26d52d2e16010e3e3e3ce0e8a1a0ce">status</a>, void *param)</td></tr>
<tr class="memdesc:ga0146c4f3ef32320d6fc869b9018ffeeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">S2PI layer callback function type for the SPI transfer completed event.  <br /></td></tr>
<tr class="separator:ga0146c4f3ef32320d6fc869b9018ffeeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9401acadf486ee660bfb6900da57719c" id="r_ga9401acadf486ee660bfb6900da57719c"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9401acadf486ee660bfb6900da57719c">s2pi_irq_callback_t</a>) (void *param)</td></tr>
<tr class="memdesc:ga9401acadf486ee660bfb6900da57719c"><td class="mdescLeft">&#160;</td><td class="mdescRight">S2PI layer callback function type for the GPIO interrupt event.  <br /></td></tr>
<tr class="separator:ga9401acadf486ee660bfb6900da57719c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa236b64d7430965890e9c6834e24c317" id="r_gaa236b64d7430965890e9c6834e24c317"><td class="memItemLeft" align="right" valign="top">typedef int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td></tr>
<tr class="separator:gaa236b64d7430965890e9c6834e24c317"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga46259a0c53d1b2ef5952bbcbbefe5da6" id="r_ga46259a0c53d1b2ef5952bbcbbefe5da6"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">s2pi_pin_t</a> { <br />
&#160;&#160;<a class="el" href="#gga46259a0c53d1b2ef5952bbcbbefe5da6a9f9a9c2913d03c9cf52ee068847379c5">S2PI_CLK</a>
, <br />
&#160;&#160;<a class="el" href="#gga46259a0c53d1b2ef5952bbcbbefe5da6af6d380a1383f06f63162ce8fbd630833">S2PI_CS</a>
, <br />
&#160;&#160;<a class="el" href="#gga46259a0c53d1b2ef5952bbcbbefe5da6a37e3961ae1ce0bca3f3fcc29d57e9c1b">S2PI_MOSI</a>
, <br />
&#160;&#160;<a class="el" href="#gga46259a0c53d1b2ef5952bbcbbefe5da6a7df36a3c08db9355bcf743e28f5b2e37">S2PI_MISO</a>
, <br />
&#160;&#160;<a class="el" href="#gga46259a0c53d1b2ef5952bbcbbefe5da6af93db1c0742862c51bd6aa927700e0ce">S2PI_IRQ</a>
<br />
 }</td></tr>
<tr class="separator:ga46259a0c53d1b2ef5952bbcbbefe5da6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga979bf52b555605a0e0c471627cd46071" id="r_ga979bf52b555605a0e0c471627cd46071"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga979bf52b555605a0e0c471627cd46071">S2PI_GetStatus</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga979bf52b555605a0e0c471627cd46071"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the status of the SPI module.  <br /></td></tr>
<tr class="separator:ga979bf52b555605a0e0c471627cd46071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b8104cb170c7cd08c702ac0fd01039d" id="r_ga0b8104cb170c7cd08c702ac0fd01039d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0b8104cb170c7cd08c702ac0fd01039d">S2PI_TryGetMutex</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga0b8104cb170c7cd08c702ac0fd01039d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to grab the SPI interface mutex for the next transfer.  <br /></td></tr>
<tr class="separator:ga0b8104cb170c7cd08c702ac0fd01039d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50973ed176c6a73d9bbca7cbcbcadc2a" id="r_ga50973ed176c6a73d9bbca7cbcbcadc2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga50973ed176c6a73d9bbca7cbcbcadc2a">S2PI_ReleaseMutex</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga50973ed176c6a73d9bbca7cbcbcadc2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the SPI interface mutex.  <br /></td></tr>
<tr class="separator:ga50973ed176c6a73d9bbca7cbcbcadc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c8f883938de571dbd73033b4957a987" id="r_ga0c8f883938de571dbd73033b4957a987"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0c8f883938de571dbd73033b4957a987">S2PI_TransferFrame</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave, uint8_t const *txData, uint8_t *rxData, size_t frameSize, <a class="el" href="#ga0146c4f3ef32320d6fc869b9018ffeeb">s2pi_callback_t</a> callback, void *callbackData)</td></tr>
<tr class="memdesc:ga0c8f883938de571dbd73033b4957a987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transfers a single SPI frame asynchronously.  <br /></td></tr>
<tr class="separator:ga0c8f883938de571dbd73033b4957a987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c25817265b19af4a9579b569774b171" id="r_ga0c25817265b19af4a9579b569774b171"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0c25817265b19af4a9579b569774b171">S2PI_Abort</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga0c25817265b19af4a9579b569774b171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminates a currently ongoing asynchronous SPI transfer.  <br /></td></tr>
<tr class="separator:ga0c25817265b19af4a9579b569774b171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e2c5cf733c131a0856ee3c3d073b29c" id="r_ga8e2c5cf733c131a0856ee3c3d073b29c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8e2c5cf733c131a0856ee3c3d073b29c">S2PI_SetIrqCallback</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave, <a class="el" href="#ga9401acadf486ee660bfb6900da57719c">s2pi_irq_callback_t</a> callback, void *callbackData)</td></tr>
<tr class="memdesc:ga8e2c5cf733c131a0856ee3c3d073b29c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a callback for the GPIO IRQ for a specified S2PI slave.  <br /></td></tr>
<tr class="separator:ga8e2c5cf733c131a0856ee3c3d073b29c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2608e23e402fcf759d57a7ff7c453e6" id="r_gad2608e23e402fcf759d57a7ff7c453e6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad2608e23e402fcf759d57a7ff7c453e6">S2PI_ReadIrqPin</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:gad2608e23e402fcf759d57a7ff7c453e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the current interrupt pending status of the IRQ pin.  <br /></td></tr>
<tr class="separator:gad2608e23e402fcf759d57a7ff7c453e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c3781ed12745026d6e24f4084b48d58" id="r_ga4c3781ed12745026d6e24f4084b48d58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4c3781ed12745026d6e24f4084b48d58">S2PI_CycleCsPin</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga4c3781ed12745026d6e24f4084b48d58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cycles the chip select line.  <br /></td></tr>
<tr class="separator:ga4c3781ed12745026d6e24f4084b48d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga48abf1c772d2f89436cba9c32a1cdcaf" id="r_ga48abf1c772d2f89436cba9c32a1cdcaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga48abf1c772d2f89436cba9c32a1cdcaf">S2PI_CaptureGpioControl</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga48abf1c772d2f89436cba9c32a1cdcaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Captures the S2PI pins for GPIO usage.  <br /></td></tr>
<tr class="separator:ga48abf1c772d2f89436cba9c32a1cdcaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35cc8f0eeec245733773f34bd5985772" id="r_ga35cc8f0eeec245733773f34bd5985772"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga35cc8f0eeec245733773f34bd5985772">S2PI_ReleaseGpioControl</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</td></tr>
<tr class="memdesc:ga35cc8f0eeec245733773f34bd5985772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the S2PI pins from GPIO usage and switches back to SPI mode.  <br /></td></tr>
<tr class="separator:ga35cc8f0eeec245733773f34bd5985772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf4e0e0945f3abef86ed42aaecf2ff861" id="r_gaf4e0e0945f3abef86ed42aaecf2ff861"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf4e0e0945f3abef86ed42aaecf2ff861">S2PI_WriteGpioPin</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave, <a class="el" href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">s2pi_pin_t</a> pin, uint32_t value)</td></tr>
<tr class="memdesc:gaf4e0e0945f3abef86ed42aaecf2ff861"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the output for a specified SPI pin in GPIO mode.  <br /></td></tr>
<tr class="separator:gaf4e0e0945f3abef86ed42aaecf2ff861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3695298d452f8af4a4bcbff930636cdc" id="r_ga3695298d452f8af4a4bcbff930636cdc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3695298d452f8af4a4bcbff930636cdc">S2PI_ReadGpioPin</a> (<a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave, <a class="el" href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">s2pi_pin_t</a> pin, uint32_t *value)</td></tr>
<tr class="memdesc:ga3695298d452f8af4a4bcbff930636cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the input from a specified SPI pin in GPIO mode.  <br /></td></tr>
<tr class="separator:ga3695298d452f8af4a4bcbff930636cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>S2PI: SPI incl. GPIO Hardware Layer Module. </p>
<hr  />
  <p>The S2PI module consists of a standard SPI interface plus a single GPIO interrupt line. Furthermore, the SPI pins are accessible via GPIO control to allow a software emulation of additional protocols using the same pins.</p>
<p><b>SPI interface:</b></p>
<p>The SPI interface is based around a single functionality:</p>
<p><a class="el" href="#ga0c8f883938de571dbd73033b4957a987" title="Transfers a single SPI frame asynchronously.">S2PI_TransferFrame</a>. This function transfers a specified number of bytes via the interfaces MOSI line and simultaneously reads the incoming data on the MOSI line. The read can also be skipped. The transfer happen asynchronously, e.g. via a DMA request. After finishing the transfer, the provided callback is invoked with the status of the transfer and the provided abstract parameter. Furthermore, the functions receives a slave parameter that can be used to connect multiple slaves, each with its individual chip select line.</p>
<p>The interface also provides functionality to change the SPI baud rate. An additional abort method is used to cancel the ongoing transfer.</p>
<p><b>GPIO interface:</b></p>
<p>The GPIO part of the S2PI interface has two distinct concerns:</p>
<p>First, the GPIO interface handles the measurement finished interrupt from the device. When the device invokes the interrupt, it pulls the interrupt line to low. Thus the interrupt must trigger when a transition from high to low occurs on the interrupt line.</p>
<p>The module simply invokes a callback when this interrupt occurs. The <a class="el" href="#ga8e2c5cf733c131a0856ee3c3d073b29c" title="Set a callback for the GPIO IRQ for a specified S2PI slave.">S2PI_SetIrqCallback</a> method is used to install the callback for a specified slave. Each slave will have its own interrupt line. An additional callback parameter can be set that would be passed to the callback function.</p>
<p>In addition to the interrupt, all SPI pins need to be accessible as GPIO pins through this interface. This is required to read the EEPROM memory on the device hat is connected to the SPI pins but requires a different protocol that is not compatible to any standard SPI interface. Therefore, the interface provides the possibility to switch to GPIO control mode that allows to emulate the EEPROM protocol via software bit banging.</p>
<p>Two methods are provided to switch forth and back between SPI and GPIO control. In GPIO mode, several functions are used to read and write the individual GPIO pins.</p>
<p>Note that the GPIO mode is only required to readout the EEPROM upon initialization of the device, i.e. during execution of the <a class="el" href="group__argus__api.html#ga7d724a6657138f112bff554f7db2a898" title="Initializes the device with default measurement mode.">Argus_Init</a> or <a class="el" href="group__argus__api.html#gab1dd6c99418b2e470a29b85721edc93f" title="Reinitializes the device with the current measurement mode.">Argus_Reinit</a> methods. The GPIO mode is not used during measurements.</p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga0146c4f3ef32320d6fc869b9018ffeeb" name="ga0146c4f3ef32320d6fc869b9018ffeeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0146c4f3ef32320d6fc869b9018ffeeb">&#9670;&#160;</a></span>s2pi_callback_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a>(* s2pi_callback_t) (<a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> <a class="el" href="group__argus__xtk__cli.html#gaea26d52d2e16010e3e3e3ce0e8a1a0ce">status</a>, void *param)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>S2PI layer callback function type for the SPI transfer completed event. </p>
<hr  />
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>The <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> of the completed transfer (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success).</td></tr>
    <tr><td class="paramname">param</td><td>The provided (optional, can be null) callback parameter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
<a id="ga9401acadf486ee660bfb6900da57719c" name="ga9401acadf486ee660bfb6900da57719c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9401acadf486ee660bfb6900da57719c">&#9670;&#160;</a></span>s2pi_irq_callback_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* s2pi_irq_callback_t) (void *param)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>S2PI layer callback function type for the GPIO interrupt event. </p>
<hr  />
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">param</td><td>The provided (optional, can be null) callback parameter. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa236b64d7430965890e9c6834e24c317" name="gaa236b64d7430965890e9c6834e24c317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa236b64d7430965890e9c6834e24c317">&#9670;&#160;</a></span>s2pi_slave_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int32_t <a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The S2PI slave identifier. Basically an user defined enumerable type that can be used to identify the slave within the SPI module. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga46259a0c53d1b2ef5952bbcbbefe5da6" name="ga46259a0c53d1b2ef5952bbcbbefe5da6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">&#9670;&#160;</a></span>s2pi_pin_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">s2pi_pin_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The enumeration of S2PI pins. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga46259a0c53d1b2ef5952bbcbbefe5da6a9f9a9c2913d03c9cf52ee068847379c5" name="gga46259a0c53d1b2ef5952bbcbbefe5da6a9f9a9c2913d03c9cf52ee068847379c5"></a>S2PI_CLK&#160;</td><td class="fielddoc"><p>The SPI clock pin. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga46259a0c53d1b2ef5952bbcbbefe5da6af6d380a1383f06f63162ce8fbd630833" name="gga46259a0c53d1b2ef5952bbcbbefe5da6af6d380a1383f06f63162ce8fbd630833"></a>S2PI_CS&#160;</td><td class="fielddoc"><p>The SPI chip select pin. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga46259a0c53d1b2ef5952bbcbbefe5da6a37e3961ae1ce0bca3f3fcc29d57e9c1b" name="gga46259a0c53d1b2ef5952bbcbbefe5da6a37e3961ae1ce0bca3f3fcc29d57e9c1b"></a>S2PI_MOSI&#160;</td><td class="fielddoc"><p>The SPI MOSI pin. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga46259a0c53d1b2ef5952bbcbbefe5da6a7df36a3c08db9355bcf743e28f5b2e37" name="gga46259a0c53d1b2ef5952bbcbbefe5da6a7df36a3c08db9355bcf743e28f5b2e37"></a>S2PI_MISO&#160;</td><td class="fielddoc"><p>The SPI MISO pin. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga46259a0c53d1b2ef5952bbcbbefe5da6af93db1c0742862c51bd6aa927700e0ce" name="gga46259a0c53d1b2ef5952bbcbbefe5da6af93db1c0742862c51bd6aa927700e0ce"></a>S2PI_IRQ&#160;</td><td class="fielddoc"><p>The IRQ pin. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga0c25817265b19af4a9579b569774b171" name="ga0c25817265b19af4a9579b569774b171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c25817265b19af4a9579b569774b171">&#9670;&#160;</a></span>S2PI_Abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_Abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminates a currently ongoing asynchronous SPI transfer. </p>
<hr  />
 <p>When a callback is set for the current ongoing activity, it is invoked with the <a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba8b9327724f35561b5736edb14c5c3b91">ERROR_ABORTED</a> error byte.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. Note that the slave information is only required if multiple SPI instances are used in order to map to the correct SPI instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
<a id="ga48abf1c772d2f89436cba9c32a1cdcaf" name="ga48abf1c772d2f89436cba9c32a1cdcaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga48abf1c772d2f89436cba9c32a1cdcaf">&#9670;&#160;</a></span>S2PI_CaptureGpioControl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_CaptureGpioControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Captures the S2PI pins for GPIO usage. </p>
<hr  />
 <p>The SPI is disabled (module status: <a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba13610f5af17a96efde6dbb5f3f4419b1">STATUS_S2PI_GPIO_MODE</a>) and the pins are configured for GPIO operation. The GPIO control must be release with the <a class="el" href="#ga35cc8f0eeec245733773f34bd5985772" title="Releases the S2PI pins from GPIO usage and switches back to SPI mode.">S2PI_ReleaseGpioControl</a> function in order to switch back to ordinary SPI functionality.</p>
<dl class="section note"><dt>Note</dt><dd>This function is only called during device initialization!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. Note that the slave information is only required if multiple SPI instances are used in order to map to the correct SPI instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
<a id="ga4c3781ed12745026d6e24f4084b48d58" name="ga4c3781ed12745026d6e24f4084b48d58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4c3781ed12745026d6e24f4084b48d58">&#9670;&#160;</a></span>S2PI_CycleCsPin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_CycleCsPin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cycles the chip select line. </p>
<hr  />
 <p>In order to cancel the integration on the ASIC, a fast toggling of the chip select pin of the corresponding SPI slave is required. Therefore, this function toggles the CS from high to low and back. The SPI instance for the specified S2PI slave must be idle, otherwise the status <a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88">STATUS_BUSY</a> is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
<a id="ga979bf52b555605a0e0c471627cd46071" name="ga979bf52b555605a0e0c471627cd46071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga979bf52b555605a0e0c471627cd46071">&#9670;&#160;</a></span>S2PI_GetStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_GetStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the status of the SPI module. </p>
<hr  />
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. Note that the slave information is only required if multiple SPI instances are used in order to map to the correct SPI instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a>:<ul>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba99ade6ecff7f9e1fb13b62be39b85d82">STATUS_IDLE</a>: No SPI transfer or GPIO access is ongoing.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88">STATUS_BUSY</a>: An SPI transfer is in progress.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba13610f5af17a96efde6dbb5f3f4419b1">STATUS_S2PI_GPIO_MODE</a>: The module is in GPIO mode. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga3695298d452f8af4a4bcbff930636cdc" name="ga3695298d452f8af4a4bcbff930636cdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3695298d452f8af4a4bcbff930636cdc">&#9670;&#160;</a></span>S2PI_ReadGpioPin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_ReadGpioPin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">s2pi_pin_t</a></td>          <td class="paramname"><span class="paramname"><em>pin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the input from a specified SPI pin in GPIO mode. </p>
<hr  />
 <p>This function reads the value of an SPI pin if the SPI pins are captured for GPIO operation via the <a class="el" href="#ga48abf1c772d2f89436cba9c32a1cdcaf" title="Captures the S2PI pins for GPIO usage.">S2PI_CaptureGpioControl</a> previously.</p>
<dl class="section note"><dt>Note</dt><dd>This function is only called during device initialization!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. </td></tr>
    <tr><td class="paramname">pin</td><td>The specified S2PI pin. </td></tr>
    <tr><td class="paramname">value</td><td>The GPIO pin state to read (0 = low, GND level, 1 = high, VCC level). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
<a id="gad2608e23e402fcf759d57a7ff7c453e6" name="gad2608e23e402fcf759d57a7ff7c453e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad2608e23e402fcf759d57a7ff7c453e6">&#9670;&#160;</a></span>S2PI_ReadIrqPin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t S2PI_ReadIrqPin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the current interrupt pending status of the IRQ pin. </p>
<hr  />
 <p>In order to keep a low priority for GPIO IRQs, the state of the IRQ pin must be read in order to reliable check for chip timeouts.</p>
<p>The execution of the interrupt service routine for the data-ready interrupt from the corresponding GPIO pin might be delayed due to priority issues. The delayed execution might disable the timeout for the eye-safety checker too late causing false error messages. In order to overcome the issue, the interrupt state of the IRQ GPIO input pin is read before raising a timeout error in order to check if the device has already finished and the IRQ is still pending to be executed!</p>
<p>Note: an easy implementation is to simply return the state of the IRQ line, i.e. 0 if there is a low input state and 1 if there is a high input state on the IRQ input pin. However, this implementation is not fully reliable since the GPIO interrupt (triggered on the falling edge) might be missed and the callback is never invoked while the IRQ line is correctly asserted to low state by the device. In that case, the API is waiting forever until the callback is invoked which might never happen. Therefore, it is better if the implementation checks the state of the IRQ pending status register or even combines both variations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1U if the IRQ is NOT pending (pin is in high state) and 0U if the IRQ is pending (pin is pulled to low state by the device). </dd></dl>

</div>
</div>
<a id="ga35cc8f0eeec245733773f34bd5985772" name="ga35cc8f0eeec245733773f34bd5985772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35cc8f0eeec245733773f34bd5985772">&#9670;&#160;</a></span>S2PI_ReleaseGpioControl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_ReleaseGpioControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the S2PI pins from GPIO usage and switches back to SPI mode. </p>
<hr  />
 <p>The GPIO pins are configured for SPI operation and the GPIO mode is left. Must be called if the pins are captured for GPIO operation via the <a class="el" href="#ga48abf1c772d2f89436cba9c32a1cdcaf" title="Captures the S2PI pins for GPIO usage.">S2PI_CaptureGpioControl</a> function.</p>
<dl class="section note"><dt>Note</dt><dd>This function is only called during device initialization!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. Note that the slave information is only required if multiple SPI instances are used in order to map to the correct SPI instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
<a id="ga50973ed176c6a73d9bbca7cbcbcadc2a" name="ga50973ed176c6a73d9bbca7cbcbcadc2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50973ed176c6a73d9bbca7cbcbcadc2a">&#9670;&#160;</a></span>S2PI_ReleaseMutex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void S2PI_ReleaseMutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the SPI interface mutex. </p>
<hr  />
 <p>Once the mutex is captured, only a single thread (the one that captured it) will call this release function, so there is no need for any test or thread safe barriers. Also there is no side effect of calling this function when the Mutex is not taken so this function can be really simple and doesn't need to return anything.</p>
<p>See <a class="el" href="#ga0b8104cb170c7cd08c702ac0fd01039d" title="Tries to grab the SPI interface mutex for the next transfer.">S2PI_TryGetMutex</a> on more information and an example implementation for the single SPI interface case.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. Note that the slave information is only required if multiple SPI instances are used in order to map to the correct SPI instance. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8e2c5cf733c131a0856ee3c3d073b29c" name="ga8e2c5cf733c131a0856ee3c3d073b29c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8e2c5cf733c131a0856ee3c3d073b29c">&#9670;&#160;</a></span>S2PI_SetIrqCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_SetIrqCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga9401acadf486ee660bfb6900da57719c">s2pi_irq_callback_t</a></td>          <td class="paramname"><span class="paramname"><em>callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>callbackData</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a callback for the GPIO IRQ for a specified S2PI slave. </p>
<hr  />
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. </td></tr>
    <tr><td class="paramname">callback</td><td>A callback function to be invoked when the specified S2PI slave IRQ occurs. Pass a null pointer to disable the callback. </td></tr>
    <tr><td class="paramname">callbackData</td><td>A pointer to a state that will be passed to the callback. Pass a null pointer if not used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a>:<ul>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a>: Successfully installation of the callback.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70baa3690c89e0fdf0b56e5e04660a6c9a70">ERROR_S2PI_INVALID_SLAVE</a>: A wrong slave identifier is provided. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga0c8f883938de571dbd73033b4957a987" name="ga0c8f883938de571dbd73033b4957a987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c8f883938de571dbd73033b4957a987">&#9670;&#160;</a></span>S2PI_TransferFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_TransferFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t const *</td>          <td class="paramname"><span class="paramname"><em>txData</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>rxData</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>frameSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga0146c4f3ef32320d6fc869b9018ffeeb">s2pi_callback_t</a></td>          <td class="paramname"><span class="paramname"><em>callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>callbackData</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transfers a single SPI frame asynchronously. </p>
<hr  />
 <p>Transfers a single SPI frame in asynchronous manner. The Tx data buffer is written to the device via the MOSI line. Optionally, the data on the MISO line is written to the provided Rx data buffer. If null, the read data is dismissed. Note that Rx and Tx buffer can be identical. I.e. the same buffer is used for writing and reading data. First, a byte is transmitted and the received byte overwrites the previously send value.</p>
<p>The transfer of a single frame requires to not toggle the chip select line to high in between the data frame. The maximum number of bytes transferred in a single SPI transfer is given by the data value register of the device, which is 396 data bytes plus a single address byte: 397 bytes.</p>
<p>An optional callback is invoked when the asynchronous transfer is finished. If the <code>callback</code> parameter is a null pointer, no callback is provided. Note that the provided buffer must not change while the transfer is ongoing.</p>
<p>Use the slave parameter to determine the corresponding slave via the given chip select line.</p>
<p>Usually, two distinct interrupts are required to handle the RX and TX ready events. The callback must be invoked from whichever interrupt comes after the SPI transfer has been finished. Note that new SPI transfers are invoked from within the callback function (i.e. from within the interrupt service routine of same priority).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. </td></tr>
    <tr><td class="paramname">txData</td><td>The 8-bit values to write to the SPI bus MOSI line. </td></tr>
    <tr><td class="paramname">rxData</td><td>The 8-bit values received from the SPI bus MISO line (pass a null pointer if the data don't need to be read). </td></tr>
    <tr><td class="paramname">frameSize</td><td>The number of 8-bit values to be sent/received. </td></tr>
    <tr><td class="paramname">callback</td><td>A callback function to be invoked when the transfer is finished. Pass a null pointer if no callback is required. </td></tr>
    <tr><td class="paramname">callbackData</td><td>A pointer to a state that will be passed to the callback. Pass a null pointer if not used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a>:<ul>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a>: Successfully invoked the transfer.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba9f5133f88de0116e3c7b131ebcf366a3">ERROR_INVALID_ARGUMENT</a>: An invalid parameter has been passed.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70baa3690c89e0fdf0b56e5e04660a6c9a70">ERROR_S2PI_INVALID_SLAVE</a>: A wrong slave identifier is provided.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88">STATUS_BUSY</a>: An SPI transfer is already in progress. The transfer was not started.</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba13610f5af17a96efde6dbb5f3f4419b1">STATUS_S2PI_GPIO_MODE</a>: The module is in GPIO mode. The transfer was not started. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga0b8104cb170c7cd08c702ac0fd01039d" name="ga0b8104cb170c7cd08c702ac0fd01039d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b8104cb170c7cd08c702ac0fd01039d">&#9670;&#160;</a></span>S2PI_TryGetMutex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_TryGetMutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to grab the SPI interface mutex for the next transfer. </p>
<hr  />
 <p>This mutex prevents new asynchronous SPI requests to interfere with transfers already in progress for this interface.</p>
<p>Note that this is only required if multiple device are connected to a single SPI interface. If only operating a single device per SPI, the function can simply always return <a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a>.</p>
<p>There must be a dedicated mutex object per SPI interface if multiple SPI interfaces are used.</p>
<p>The mutex will be released in the <a class="el" href="#ga50973ed176c6a73d9bbca7cbcbcadc2a" title="Releases the SPI interface mutex.">S2PI_ReleaseMutex</a> function. See <a class="el" href="#ga50973ed176c6a73d9bbca7cbcbcadc2a" title="Releases the SPI interface mutex.">S2PI_ReleaseMutex</a> for additional information.</p>
<p>Here is a simple example implementation for the multiple devices on a single SPI interface case. Note that the SpiMutexBlocked must be defined per SPI interface if multiple SPI interfaces are used.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keywordtype">bool</span> SpiMutexBlocked = <span class="keyword">false</span>;</div>
<div class="line"><a class="code hl_typedef" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> <a class="code hl_function" href="#ga0b8104cb170c7cd08c702ac0fd01039d">S2PI_TryGetMutex</a>(<a class="code hl_typedef" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</div>
<div class="line">{</div>
<div class="line">    (void) slave; <span class="comment">// not used in this implementation as all</span></div>
<div class="line">                  <span class="comment">// SPI slaves are on the same SPI interface</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> <a class="code hl_variable" href="group__argus__xtk__cli.html#gaea26d52d2e16010e3e3e3ce0e8a1a0ce">status</a> = <a class="code hl_enumvalue" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88">STATUS_BUSY</a>;</div>
<div class="line">    <a class="code hl_function" href="group__argus__irq.html#ga7eb2f9c9e40114afd7d079ace7c152e7">IRQ_LOCK</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (!SpiMutexBlocked)</div>
<div class="line">    {</div>
<div class="line">        SpiMutexBlocked = <span class="keyword">true</span>;</div>
<div class="line">        <a class="code hl_variable" href="group__argus__xtk__cli.html#gaea26d52d2e16010e3e3e3ce0e8a1a0ce">status</a> = <a class="code hl_enumvalue" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__argus__irq.html#ga41f0d51315c5971183de8750606eab22">IRQ_UNLOCK</a>();</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="group__argus__xtk__cli.html#gaea26d52d2e16010e3e3e3ce0e8a1a0ce">status</a>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="#ga50973ed176c6a73d9bbca7cbcbcadc2a">S2PI_ReleaseMutex</a>(<a class="code hl_typedef" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a> slave)</div>
<div class="line">{</div>
<div class="line">    (void) slave; <span class="comment">// not used in this implementation</span></div>
<div class="line">    SpiMutexBlocked = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__argus__api_html_gaa236b64d7430965890e9c6834e24c317"><div class="ttname"><a href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></div><div class="ttdeci">int32_t s2pi_slave_t</div><div class="ttdef"><b>Definition</b> argus_api.h:67</div></div>
<div class="ttc" id="agroup__argus__irq_html_ga41f0d51315c5971183de8750606eab22"><div class="ttname"><a href="group__argus__irq.html#ga41f0d51315c5971183de8750606eab22">IRQ_UNLOCK</a></div><div class="ttdeci">void IRQ_UNLOCK(void)</div><div class="ttdoc">Enable IRQ Interrupts.</div></div>
<div class="ttc" id="agroup__argus__irq_html_ga7eb2f9c9e40114afd7d079ace7c152e7"><div class="ttname"><a href="group__argus__irq.html#ga7eb2f9c9e40114afd7d079ace7c152e7">IRQ_LOCK</a></div><div class="ttdeci">void IRQ_LOCK(void)</div><div class="ttdoc">Disable IRQ Interrupts.</div></div>
<div class="ttc" id="agroup__argus__s2pi_html_ga0b8104cb170c7cd08c702ac0fd01039d"><div class="ttname"><a href="#ga0b8104cb170c7cd08c702ac0fd01039d">S2PI_TryGetMutex</a></div><div class="ttdeci">status_t S2PI_TryGetMutex(s2pi_slave_t slave)</div><div class="ttdoc">Tries to grab the SPI interface mutex for the next transfer.</div></div>
<div class="ttc" id="agroup__argus__s2pi_html_ga50973ed176c6a73d9bbca7cbcbcadc2a"><div class="ttname"><a href="#ga50973ed176c6a73d9bbca7cbcbcadc2a">S2PI_ReleaseMutex</a></div><div class="ttdeci">void S2PI_ReleaseMutex(s2pi_slave_t slave)</div><div class="ttdoc">Releases the SPI interface mutex.</div></div>
<div class="ttc" id="agroup__argus__status_html_gaaabdaf7ee58ca7269bd4bf24efcde092"><div class="ttname"><a href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a></div><div class="ttdeci">int32_t status_t</div><div class="ttdoc">Type used for all status and error return values.</div><div class="ttdef"><b>Definition</b> argus_status.h:70</div></div>
<div class="ttc" id="agroup__argus__status_html_gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88"><div class="ttname"><a href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88">STATUS_BUSY</a></div><div class="ttdeci">@ STATUS_BUSY</div><div class="ttdef"><b>Definition</b> argus_status.h:89</div></div>
<div class="ttc" id="agroup__argus__status_html_gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566"><div class="ttname"><a href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a></div><div class="ttdeci">@ STATUS_OK</div><div class="ttdef"><b>Definition</b> argus_status.h:80</div></div>
<div class="ttc" id="agroup__argus__xtk__cli_html_gaea26d52d2e16010e3e3e3ce0e8a1a0ce"><div class="ttname"><a href="group__argus__xtk__cli.html#gaea26d52d2e16010e3e3e3ce0e8a1a0ce">status</a></div><div class="ttdeci">static status_t status</div><div class="ttdef"><b>Definition</b> argus_xtalk_cal_cli.c:140</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. Note that the slave information is only required if multiple SPI instances are used in order to map to the correct SPI instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a>:<ul>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a>: the SPI interface was successfully reserved for the caller</li>
<li><a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba27b7b4ca606d6208a2ada6df1af6ab88">STATUS_BUSY</a>: another transfer is ongoing, the caller must not access the bus </li>
</ul>
</dd></dl>

</div>
</div>
<a id="gaf4e0e0945f3abef86ed42aaecf2ff861" name="gaf4e0e0945f3abef86ed42aaecf2ff861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf4e0e0945f3abef86ed42aaecf2ff861">&#9670;&#160;</a></span>S2PI_WriteGpioPin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status_t</a> S2PI_WriteGpioPin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__argus__api.html#gaa236b64d7430965890e9c6834e24c317">s2pi_slave_t</a></td>          <td class="paramname"><span class="paramname"><em>slave</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga46259a0c53d1b2ef5952bbcbbefe5da6">s2pi_pin_t</a></td>          <td class="paramname"><span class="paramname"><em>pin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes the output for a specified SPI pin in GPIO mode. </p>
<hr  />
 <p>This function writes the value of an SPI pin if the SPI pins are captured for GPIO operation via the <a class="el" href="#ga48abf1c772d2f89436cba9c32a1cdcaf" title="Captures the S2PI pins for GPIO usage.">S2PI_CaptureGpioControl</a> previously.</p>
<dl class="section note"><dt>Note</dt><dd>Since some GPIO peripherals switch the GPIO pins very fast a delay must be added after each GBIO access (i.e. right before returning from the <a class="el" href="#gaf4e0e0945f3abef86ed42aaecf2ff861" title="Writes the output for a specified SPI pin in GPIO mode.">S2PI_WriteGpioPin</a> method) in order to decrease the baud rate of the software EEPROM protocol. Increase the delay if timing issues occur while reading the EERPOM. For example: Delay = 10 µsec =&gt; Baud Rate &lt; 100 kHz</dd>
<dd>
This function is only called during device initialization!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave</td><td>The specified S2PI slave. </td></tr>
    <tr><td class="paramname">pin</td><td>The specified S2PI pin. </td></tr>
    <tr><td class="paramname">value</td><td>The GPIO pin state to write (0 = low, 1 = high). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the <a class="el" href="group__argus__status.html#gaaabdaf7ee58ca7269bd4bf24efcde092">status</a> (<a class="el" href="group__argus__status.html#gga67a0db04d321a74b7e7fcfd3f1a3f70ba7e4a42e3b6dd63708c64cf3db6f69566">STATUS_OK</a> on success). </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="footer"> 
			<a href="https://www.broadcom.com/">Broadcom Inc.</a>
		</li>
	</ul>
</div>
</body>
</html>
